<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MoxiWorks Demo Widget</title>
    <style>
      html,
      body {
        height: 100%;
        overflow: hidden;
        background: var(--mds-color-secondary-ultralight);
        margin: 0;
      }
    </style>

    <!-- Import the MoxiWorks Design System stylesheet -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@moxiworks/mds@0.5.0/dist/styles/mds-core.css"
    />
    <!-- Import the MoxiWorks Design System components -->
    <script type="module">
      import { defineCustomElements } from "https://cdn.jsdelivr.net/npm/@moxiworks/mds@0.5.0/loader/index.es2017.js";
      defineCustomElements();
    </script>
  </head>

  <!-- The .mds class is required for the MoxiWorks Design System. -->
  <body class="mds">
    <div class="min-h-full flex items-center justify-center text-center p-24">
      <main class="hidden text-4">
        <h1 class="text-1">Hello <span id="full-name"></span>!</h1>
        <p class="my-0">
          Your MLS number is
          <span id="mls-number" class="font-bold"></span>.
        </p>
        <p class="my-0">
          Your NRDS number is
          <span id="nrds-number" class="font-bold"></span>.
        </p>
        <section id="expanded" class="hidden">
          <p>This is a demo widget that has been expanded.</p>
          <p>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do
            eiusmod tempor incididunt ut labore et dolore magna aliqua. Id
            interdum velit laoreet id donec ultrices tincidunt arcu non. Est
            velit egestas dui id ornare arcu odio ut sem. Nibh sit amet commodo
            nulla facilisi nullam. Morbi tincidunt ornare massa eget egestas
            purus viverra accumsan in. Et malesuada fames ac turpis egestas
            integer eget aliquet nibh. Fames ac turpis egestas integer eget
            aliquet nibh praesent. Sed ullamcorper morbi tincidunt ornare massa.
            Tellus molestie nunc non blandit massa. Euismod quis viverra nibh
            cras pulvinar mattis nunc sed. Fringilla phasellus faucibus
            scelerisque eleifend donec pretium vulputate sapien nec. Gravida
            dictum fusce ut placerat orci nulla. Enim lobortis scelerisque
            fermentum dui faucibus in ornare quam viverra.
          </p>
          <p>
            Iaculis nunc sed augue lacus viverra vitae congue eu consequat.
            Purus sit amet luctus venenatis lectus magna. Tellus in metus
            vulputate eu scelerisque. Facilisi etiam dignissim diam quis enim
            lobortis scelerisque fermentum. Accumsan sit amet nulla facilisi
            morbi tempus iaculis urna id. Ipsum suspendisse ultrices gravida
            dictum fusce ut placerat. Eget nunc lobortis mattis aliquam faucibus
            purus in massa. Vitae sapien pellentesque habitant morbi tristique
            senectus et. Mattis aliquam faucibus purus in massa tempor nec
            feugiat. Sit amet facilisis magna etiam tempor. Tempor commodo
            ullamcorper a lacus vestibulum sed arcu non.
          </p>
          <p>
            Egestas maecenas pharetra convallis posuere morbi leo urna molestie.
            Sagittis id consectetur purus ut. Vel pretium lectus quam id leo in
            vitae turpis massa. Consequat semper viverra nam libero justo
            laoreet sit amet cursus. Sed vulputate mi sit amet mauris. Sed
            turpis tincidunt id aliquet risus feugiat. Nibh ipsum consequat nisl
            vel pretium lectus quam. Risus at ultrices mi tempus imperdiet nulla
            malesuada pellentesque elit. Malesuada fames ac turpis egestas. Dui
            sapien eget mi proin sed libero. Id velit ut tortor pretium viverra
            suspendisse. Mattis molestie a iaculis at.
          </p>
          <p>
            Nulla facilisi nullam vehicula ipsum a. Neque viverra justo nec
            ultrices dui. Eu tincidunt tortor aliquam nulla facilisi cras.
            Tellus id interdum velit laoreet id donec ultrices. Lacus
            suspendisse faucibus interdum posuere lorem ipsum dolor. Sodales ut
            etiam sit amet nisl purus in. Fermentum leo vel orci porta. Blandit
            massa enim nec dui nunc mattis enim ut. Non diam phasellus
            vestibulum lorem sed risus ultricies. Felis eget velit aliquet
            sagittis id consectetur purus ut. Nibh cras pulvinar mattis nunc sed
            blandit libero volutpat sed. Vitae congue mauris rhoncus aenean vel
            elit. Dui sapien eget mi proin. Volutpat ac tincidunt vitae semper
            quis lectus nulla. Vehicula ipsum a arcu cursus vitae. Id leo in
            vitae turpis massa sed. Tempus imperdiet nulla malesuada
            pellentesque elit eget gravida. Mi eget mauris pharetra et. In metus
            vulputate eu scelerisque. Nisi vitae suscipit tellus mauris a diam
            maecenas.
          </p>
          <p>
            Id interdum velit laoreet id donec ultrices tincidunt arcu non.
            Pulvinar etiam non quam lacus suspendisse. Porttitor rhoncus dolor
            purus non enim praesent elementum facilisis leo. Mattis vulputate
            enim nulla aliquet porttitor lacus luctus accumsan tortor. Ac ut
            consequat semper viverra nam libero justo. Ac turpis egestas
            maecenas pharetra convallis posuere morbi. Tempus egestas sed sed
            risus. Id consectetur purus ut faucibus pulvinar elementum integer
            enim. Est ullamcorper eget nulla facilisi etiam dignissim diam quis
            enim. Pretium aenean pharetra magna ac placerat vestibulum lectus
            mauris ultrices. Purus sit amet luctus venenatis lectus.
          </p>
        </section>
        <p class="my-0 mt-8">
          <a href="https://github.com/moxiworks/demo-widget" target="_blank">
            View the source code
          </a>
        </p>
      </main>

      <div id="error" class="hidden">
        This widget expects the following query string parameters:
        <ul class="list-disc pl-20">
          <li><code>mls-number</code></li>
          <li><code>nrds-number</code></li>
          <li><code>full-name</code></li>
        </ul>
        <p>You may also set <code>expanded=1</code> for additional content.</p>
      </div>
    </div>

    <noscript>
      <p>
        This widget requires JavaScript. Please enable JavaScript in your
        browser and reload the page.
      </p>
    </noscript>

    <script>
      // The following query string should be entered into the developer portal for this widget:
      // ?mls-number={MLS_NUMBER}&nrds-number={NRDS_NUMBER}&full-name={FULL_NAME}
      // The delimited variables are replaced with values for the current user.

      const urlParams = new URLSearchParams(window.location.search);
      const mlsNumber = urlParams.get("mls-number");
      const nrdsNumber = urlParams.get("nrds-number");
      const fullName = urlParams.get("full-name");
      const expanded = urlParams.get("expanded");

      if ([mlsNumber, nrdsNumber, fullName].every((value) => !!value)) {
        showWidget();
      } else {
        showWidgetError();
      }

      if (expanded) {
        document.getElementById("expanded").classList.remove("hidden");
        document.body.style.overflow = "auto";
        document.documentElement.style.fontSize = "20px";
        document.querySelector("main").classList.add("text-left");
      }

      /** Place user values in the DOM, and show the widget content. */
      function showWidget() {
        const mlsNumberPlaceholder = document.getElementById("mls-number");
        const nrdsNumberPlaceholder = document.getElementById("nrds-number");
        const fullNamePlaceholder = document.getElementById("full-name");

        mlsNumberPlaceholder.innerText = urlParams.get("mls-number");
        nrdsNumberPlaceholder.innerText = urlParams.get("nrds-number");
        fullNamePlaceholder.innerText = urlParams.get("full-name");

        document.querySelector("main").classList.remove("hidden");
      }

      /** Show the error message (if query params are missing). */
      function showWidgetError() {
        document.querySelector("#error").classList.remove("hidden");
      }
    </script>
  </body>
</html>
